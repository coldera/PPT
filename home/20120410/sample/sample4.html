<!DOCTYPE html>
<html>
<head>
<title>D2-编写可维护可扩展的JS组件</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../../frame.css" />
</head>
<body>
<header id="header">
    <h1>增强</h1>
</header>
<div id="content">
    <nav>
        <ol>
            <li>常规业务流程代码</li>
            <li>添加回调函数</li>
            <li>让流程可中断</li>
            <li>让中断彻底一点</li>
        </ol>
    </nav>
    <div id="body">
        <div class="wrap">
            <section class="item">
                <h2>常规业务流程代码</h2>
                <pre class="content">
            <code>
                (function() {
                    function main() {
                        qiChuang();
                        chiZaoCang();
                        shangBan();
                    }
                    
                    function qiChuang() {
                        ...（此处省略100行代码）
                    }
                    function chiZaoCang() {
                        ...（此处省略100行代码）
                    }
                    function shangBan() {
                        ...（此处省略100行代码）
                    }
                
                    main();
                })();
            </code>
                </pre>
            </section>
            
            <section class="item">
                <h2>添加回调函数</h2>
                <pre class="content">
            <code>
                (function() {
                    var callback = {};
                
                    function main(callbackSettings) {
                        $.extend(callback, callbackSettings);
                    
                        qiChuang();
                        chiZaoCang();
                        shangBan();
                    }
                    
                    function qiChuang() {
                        ...（此处省略100行代码）
                    }
                    function chiZaoCang() {
                        <em>
                        if(typeof callback.beforeChiZaoCang == 'function') {
                            callback.beforeChiZaoCang();
                        }
                        </em>
                    
                        ...（此处省略100行代码）
                        
                        <em>
                        if(typeof callback.afterChiZaoCang == 'function') {
                            callback.afterChiZaoCang();
                        }
                        </em>
                    }
                    function shangBan() {
                        ...（此处省略100行代码）
                    }
                
                    main({
                        beforeChiZaoCang: function() { ... },
                        afterChiZaoCang: function() { ... }
                    });
                })();
            </code>
                </pre>
            </section>

            <section class="item">
                <h2>让流程可中断</h2>
                <pre class="content">
            <code>
                (function() {
                    var callback = {};
                
                    function main(callbackSettings) {
                        $.extend(callback, callbackSettings);
                    
                        qiChuang();
                        chiZaoCang();
                        shangBan();
                    }
                    
                    function qiChuang() {
                        ...（此处省略100行代码）
                    }
                    function chiZaoCang() {
                        if(typeof callback.beforeChiZaoCang == 'function') {
                            if(callback.beforeChiZaoCang() === false) return;
                        }
                    
                        ...（此处省略100行代码）
                        
                        if(typeof callback.afterChiZaoCang == 'function') {
                            callback.afterChiZaoCang();
                        }
                    }
                    function shangBan() {
                        ...（此处省略100行代码）
                    }
                
                    main({
                        beforeChiZaoCang: function() { ... },
                        afterChiZaoCang: function() { ... }
                    });
                })();
            </code>
                </pre>
            </section>
            
            <section class="item">
                <h2>让中断彻底一点</h2>
                <pre class="content">
            <code>
                (function() {
                    var callback = {};
                
                    function main(callbackSettings) {
                        $.extend(callback, callbackSettings);
                        try{
                            qiChuang();
                            chiZaoCang();
                            shangBan();
                        }catch() {}
                    }
                    
                    function qiChuang() {
                        ...（此处省略100行代码）
                    }
                    function chiZaoCang() {
                        if(typeof callback.beforeChiZaoCang == 'function') {
                            if(callback.beforeChiZaoCang() === false) <em>throw('beforeChiZaoCang');</em>
                        }
                    
                        ...（此处省略100行代码）
                        
                        if(typeof callback.afterChiZaoCang == 'function') {
                            callback.afterChiZaoCang();
                        }
                    }
                    function shangBan() {
                        ...（此处省略100行代码）
                    }
                
                    main({
                        beforeChiZaoCang: function() { ... },
                        afterChiZaoCang: function() { ... }
                    });
                })();
            </code>
                </pre>
            </section>
          </div>
    </div>
</div>

<script type="text/javascript">
var menuSetting = {
    '常规业务流程代码': 0,
    '添加回调函数': 1,
    '让流程可中断': 2,
    '让中断彻底一点': 3
}
</script>
<script src="../../frame.js" type="text/javascript"></script>
</body>
</html>
